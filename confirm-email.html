<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Confirmando E-mail...</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 flex items-center justify-center h-screen">
    <div class="bg-white p-8 rounded-lg shadow-md text-center max-w-md w-full">
        <h2 id="status" class="text-xl font-bold mb-4">Verificando...</h2>
        <p id="message" class="text-gray-600 mb-4">Aguarde um momento.</p>
        <a href="login.html" id="btn" class="hidden bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700">Ir para Login</a>
    </div>

    <script type="module">
        import { api } from './js/api.js'; // Garanta que api.js esteja acess√≠vel ou use fetch direto

        // Fun√ß√£o auxiliar caso api.js n√£o tenha confirmEmail
        async function confirm(token) {
            const res = await fetch('https://backend-aerofestas-production.up.railway.app/api/auth/confirm-email', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ token })
            });
            return await res.json();
        }

        const params = new URLSearchParams(window.location.search);
        const token = params.get('token');
        const statusEl = document.getElementById('status');
        const msgEl = document.getElementById('message');
        const btn = document.getElementById('btn');

        if (token) {
            confirm(token).then(data => {
                if (data.message) {
                    statusEl.textContent = "Sucesso! üéâ";
                    statusEl.className = "text-xl font-bold mb-4 text-green-600";
                    msgEl.textContent = "Seu e-mail foi confirmado.";
                    btn.classList.remove('hidden');
                } else {
                    throw new Error(data.error);
                }
            }).catch(err => {
                statusEl.textContent = "Erro";
                statusEl.className = "text-xl font-bold mb-4 text-red-600";
                msgEl.textContent = "Token inv√°lido ou expirado.";
            });
        } else {
            msgEl.textContent = "Link inv√°lido (sem token).";
        }
    </script>
</body>
</html>